---
title: "Session Runtime API"
description: "Execute messages and interact with agent sessions"
---

The Session Runtime API allows you to execute messages in sessions, retrieve conversation history, and check session status.

## Authentication

All endpoints require authentication using your API key:
- **API Key**: `x-api-key: <key>`

---

## Execute Message

<ParamField query="POST" path="/api/v1/runtime/{session_id}/execute/">
  Execute a message in an existing session and get the agent's response
</ParamField>

### Path Parameters

<ParamField path="session_id" type="string" required>
  The session ID
</ParamField>

### Request Body

<ParamField body="content" type="string | array" required>
  The message content. Can be a simple string or multimodal content blocks.
</ParamField>

<ParamField body="correlation_id" type="string">
  Optional correlation ID for tracking related events
</ParamField>

**Simple text message:**
```json
{
  "content": "What is the weather like today?"
}
```

**Multimodal message (with images):**
```json
{
  "content": [
    {
      "type": "text",
      "text": "What's in this image?"
    },
    {
      "type": "image_url",
      "image_url": {
        "url": "https://example.com/image.jpg"
      }
    }
  ]
}
```

### Response

```json
{
  "id": "session_abc123",
  "object": "agent.session",
  "status": "completed",
  "created_at": "2024-01-15T10:30:00Z",
  "completed_at": "2024-01-15T10:30:05Z",
  "config": {...},
  "messages": [
    {
      "id": "msg_user_123",
      "role": "user",
      "content": "What is the weather like today?",
      "created_at": 1705315800
    },
    {
      "id": "msg_assistant_124",
      "role": "assistant",
      "content": "I'll help you check the weather. Let me search for current weather information.",
      "created_at": 1705315802
    }
  ],
  "execution_time": 2.45,
  "metadata": {
    "correlation_id": "corr_xyz",
    "event_count": 15,
    "execution_id": "exec_789",
    "usage": {
      "prompt_tokens": 150,
      "completion_tokens": 75,
      "total_tokens": 225
    }
  }
}
```

### Example

<CodeGroup>
```bash cURL
curl -X POST https://api-be.atthene.com/api/v1/runtime/session_abc123/execute/ \
  -H "x-api-key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "content": "What is the weather like today?",
    "correlation_id": "corr_xyz"
  }'
```

```python Python
import requests

data = {
    "content": "What is the weather like today?",
    "correlation_id": "corr_xyz"
}

response = requests.post(
    "https://api-be.atthene.com/api/v1/runtime/session_abc123/execute/",
    headers={"x-api-key": "YOUR_API_KEY"},
    json=data
)

result = response.json()
print(f"Agent response: {result['messages'][-1]['content']}")
print(f"Execution time: {result['execution_time']}s")
```

```javascript JavaScript
const data = {
  content: "What is the weather like today?",
  correlation_id: "corr_xyz"
};

const response = await fetch(
  'https://api-be.atthene.com/api/v1/runtime/session_abc123/execute/',
  {
    method: 'POST',
    headers: {
      'x-api-key': 'YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
  }
);

const result = await response.json();
console.log(`Agent response: ${result.messages[result.messages.length - 1].content}`);
```
</CodeGroup>

<Tip>
The execute endpoint uses HTTP long-polling and returns all events in a single response when execution completes. Typical execution time is 2-4 seconds, with a 30-second timeout.
</Tip>

---

## Get Session Messages

<ParamField query="GET" path="/api/v1/runtime/{session_id}/messages/">
  Retrieve all messages from a session
</ParamField>

### Path Parameters

<ParamField path="session_id" type="string" required>
  The session ID
</ParamField>

### Response

```json
{
  "session_id": "session_abc123",
  "messages": [
    {
      "id": "msg_123",
      "role": "user",
      "content": "Hello, I need help",
      "created_at": 1705315800
    },
    {
      "id": "msg_124",
      "role": "assistant",
      "content": "Hello! I'm here to help. What can I assist you with?",
      "created_at": 1705315802
    },
    {
      "id": "msg_125",
      "role": "user",
      "content": "What is the weather?",
      "created_at": 1705315810
    },
    {
      "id": "msg_126",
      "role": "assistant",
      "content": "Let me check the weather for you...",
      "created_at": 1705315812,
      "metadata": {
        "thinking": "I need to use the weather tool to get current conditions"
      }
    }
  ],
  "total": 4
}
```

### Example

<CodeGroup>
```bash cURL
curl -X GET https://api-be.atthene.com/api/v1/runtime/session_abc123/messages/ \
  -H "x-api-key: YOUR_API_KEY"
```

```python Python
import requests

response = requests.get(
    "https://api-be.atthene.com/api/v1/runtime/session_abc123/messages/",
    headers={"x-api-key": "YOUR_API_KEY"}
)

messages = response.json()
print(f"Total messages: {messages['total']}")
for msg in messages['messages']:
    print(f"{msg['role']}: {msg['content']}")
```

```javascript JavaScript
const response = await fetch(
  'https://api-be.atthene.com/api/v1/runtime/session_abc123/messages/',
  {
    headers: {
      'x-api-key': 'YOUR_API_KEY'
    }
  }
);

const data = await response.json();
console.log(`Total messages: ${data.total}`);
data.messages.forEach(msg => {
  console.log(`${msg.role}: ${msg.content}`);
});
```
</CodeGroup>

---

## Get Session Status

<ParamField query="GET" path="/api/v1/runtime/{session_id}/status/">
  Get the current status and basic information about a session
</ParamField>

### Path Parameters

<ParamField path="session_id" type="string" required>
  The session ID
</ParamField>

### Response

```json
{
  "id": "session_abc123",
  "status": "active",
  "created_at": 1705315800,
  "updated_at": 1705315850,
  "title": "Support Session"
}
```

### Example

<CodeGroup>
```bash cURL
curl -X GET https://api-be.atthene.com/api/v1/runtime/session_abc123/status/ \
  -H "x-api-key: YOUR_API_KEY"
```

```python Python
import requests

response = requests.get(
    "https://api-be.atthene.com/api/v1/runtime/session_abc123/status/",
    headers={"x-api-key": "YOUR_API_KEY"}
)

status = response.json()
print(f"Session status: {status['status']}")
```
</CodeGroup>

---

## Message Roles

<ResponseField name="role" type="string">
  The role of the message sender:
  
  - `user` - Message from the user
  - `assistant` - Message from the agent
  - `tool` - Tool execution result
</ResponseField>

---

## Execution Flow

<Steps>
  <Step title="Create Session">
    First, create a session with your agent configuration using the Sessions API.
  </Step>
  
  <Step title="Execute Messages">
    Send user messages to the session using the execute endpoint. The agent will process the message and return a response.
  </Step>
  
  <Step title="Retrieve History">
    Use the messages endpoint to retrieve the full conversation history at any time.
  </Step>
  
  <Step title="Check Status">
    Monitor session status to track execution state.
  </Step>
</Steps>

---

## Complete Example

Here's a complete example of creating a session and executing a conversation:

<CodeGroup>
```python Python
import requests

BASE_URL = "https://api-be.atthene.com/api/v1"
headers = {"x-api-key": "YOUR_API_KEY"}

# 1. Create a session
session_config = {
    "name": "Weather Assistant",
    "agent_type": "react_agent",
    "system_prompt": "You are a helpful weather assistant.",
    "llm_config": {
        "model": "gpt-4o",
        "temperature": 0.7
    },
    "tools": ["tavily_search"]
}

session_response = requests.post(
    f"{BASE_URL}/sessions/",
    headers=headers,
    json=session_config
)
session = session_response.json()
session_id = session['session_id']
print(f"Created session: {session_id}")

# 2. Execute a message
execute_data = {
    "content": "What's the weather in San Francisco?"
}

execute_response = requests.post(
    f"{BASE_URL}/runtime/{session_id}/execute/",
    headers=headers,
    json=execute_data
)
result = execute_response.json()

# 3. Print the agent's response
assistant_message = result['messages'][-1]
print(f"Agent: {assistant_message['content']}")
print(f"Execution time: {result['execution_time']}s")

# 4. Get full message history
messages_response = requests.get(
    f"{BASE_URL}/runtime/{session_id}/messages/",
    headers=headers
)
messages = messages_response.json()
print(f"Total messages in session: {messages['total']}")
```

```javascript JavaScript
const BASE_URL = 'https://api-be.atthene.com/api/v1';
const headers = {
  'x-api-key': 'YOUR_API_KEY',
  'Content-Type': 'application/json'
};

// 1. Create a session
const sessionConfig = {
  name: "Weather Assistant",
  agent_type: "react_agent",
  system_prompt: "You are a helpful weather assistant.",
  llm_config: {
    model: "gpt-4o",
    temperature: 0.7
  },
  tools: ["tavily_search"]
};

const sessionResponse = await fetch(`${BASE_URL}/sessions/`, {
  method: 'POST',
  headers,
  body: JSON.stringify(sessionConfig)
});
const session = await sessionResponse.json();
const sessionId = session.session_id;
console.log(`Created session: ${sessionId}`);

// 2. Execute a message
const executeData = {
  content: "What's the weather in San Francisco?"
};

const executeResponse = await fetch(
  `${BASE_URL}/runtime/${sessionId}/execute/`,
  {
    method: 'POST',
    headers,
    body: JSON.stringify(executeData)
  }
);
const result = await executeResponse.json();

// 3. Print the agent's response
const assistantMessage = result.messages[result.messages.length - 1];
console.log(`Agent: ${assistantMessage.content}`);
console.log(`Execution time: ${result.execution_time}s`);

// 4. Get full message history
const messagesResponse = await fetch(
  `${BASE_URL}/runtime/${sessionId}/messages/`,
  { headers }
);
const messages = await messagesResponse.json();
console.log(`Total messages in session: ${messages.total}`);
```
</CodeGroup>

---

## Error Responses

<AccordionGroup>
  <Accordion title="400 Bad Request">
    Invalid message or session state
    
    ```json
    {
      "error": {
        "type": "validation_error",
        "message": "Invalid message format",
        "details": {...}
      }
    }
    ```
  </Accordion>
  
  <Accordion title="404 Not Found">
    Session not found
    
    ```json
    {
      "error": {
        "type": "not_found",
        "message": "Session not found"
      }
    }
    ```
  </Accordion>
  
  <Accordion title="500 Internal Server Error">
    Execution failed
    
    ```json
    {
      "error": {
        "type": "execution_error",
        "message": "Failed to execute message"
      }
    }
    ```
  </Accordion>
  
  <Accordion title="Timeout">
    Execution exceeded 30-second timeout
    
    ```json
    {
      "status": "error",
      "error": "Execution timeout (30s)",
      "session_id": "session_abc123"
    }
    ```
  </Accordion>
</AccordionGroup>
