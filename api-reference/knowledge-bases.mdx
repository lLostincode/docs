---
title: "Knowledge Bases API"
description: "Create and manage knowledge bases for agent retrieval"
---

The Knowledge Bases API allows you to create and manage knowledge bases that agents can query for information. Knowledge bases organize collections and data sources for AI-powered retrieval.

## Authentication

All endpoints require authentication using your API key:
- **API Key**: `x-api-key: <key>`

---

## List Knowledge Bases

<ParamField query="GET" path="/api/v1/knowledge-bases/">
  Retrieve all knowledge bases for the authenticated user's company
</ParamField>

### Query Parameters

<ParamField query="status" type="string">
  Filter by status: `pending`, `running`, `completed`, `failed`
</ParamField>

<ParamField query="processing_engine" type="string">
  Filter by processing engine: `milvus`, `cognee`
</ParamField>

### Response

```json
[
  {
    "id": "kb_123",
    "name": "Product Knowledge Base",
    "description": "Product documentation and guides",
    "processing_engine": "milvus",
    "status": "completed",
    "progress": 100,
    "collection_count": 2,
    "ingested_datasources": [...],
    "failed_datasources": [],
    "success_rate": 100,
    "created_by_name": "John Doe",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:35:00Z"
  }
]
```

### Example

<CodeGroup>
```bash cURL
curl -X GET "https://api-be.atthene.com/api/v1/knowledge-bases/?processing_engine=milvus" \
  -H "x-api-key: YOUR_API_KEY"
```

```python Python
import requests

response = requests.get(
    "https://api-be.atthene.com/api/v1/knowledge-bases/",
    headers={"x-api-key": "YOUR_API_KEY"},
    params={"processing_engine": "milvus"}
)
knowledge_bases = response.json()
```
</CodeGroup>

---

## Create Knowledge Base

<ParamField query="POST" path="/api/v1/knowledge-bases/">
  Create a new knowledge base with specified collections and processing engine
</ParamField>

### Request Body

<ParamField body="name" type="string" required>
  Knowledge base name (must be unique per company)
</ParamField>

<ParamField body="description" type="string">
  Optional description
</ParamField>

<ParamField body="processing_engine" type="string" required>
  Processing engine: `milvus` or `cognee`
</ParamField>

<ParamField body="collections" type="array" required>
  Array of collection IDs to include in the knowledge base
</ParamField>

<ParamField body="embedding_config" type="object">
  Optional embedding configuration with provider and model
</ParamField>

```json
{
  "name": "Support Knowledge Base",
  "description": "Customer support documentation and FAQs",
  "processing_engine": "milvus",
  "collections": ["coll_123", "coll_456"],
  "embedding_config": {
    "provider": "mistral",
    "model": "mistral-embed"
  }
}
```

### Response

```json
{
  "success": true,
  "message": "Knowledge base 'Support Knowledge Base' created successfully",
  "knowledge_base": {
    "id": "kb_789",
    "name": "Support Knowledge Base",
    "description": "Customer support documentation and FAQs",
    "processing_engine": "milvus",
    "status": "running",
    "progress": 0,
    "collections": [
      {
        "id": "coll_123",
        "name": "Support Guides",
        "description": "...",
        "datasources": [...]
      },
      {
        "id": "coll_456",
        "name": "FAQs",
        "description": "...",
        "datasources": [...]
      }
    ],
    "collection_count": 2,
    "total_datasources": 15,
    "ingested_datasources": [],
    "failed_datasources": [],
    "success_rate": 0,
    "created_at": "2024-01-15T10:40:00Z",
    "updated_at": "2024-01-15T10:40:00Z"
  }
}
```

### Example

<CodeGroup>
```bash cURL
curl -X POST https://api-be.atthene.com/api/v1/knowledge-bases/ \
  -H "x-api-key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Support Knowledge Base",
    "description": "Customer support documentation",
    "processing_engine": "milvus",
    "collections": ["coll_123", "coll_456"]
  }'
```

```python Python
import requests

data = {
    "name": "Support Knowledge Base",
    "description": "Customer support documentation",
    "processing_engine": "milvus",
    "collections": ["coll_123", "coll_456"]
}

response = requests.post(
    "https://api-be.atthene.com/api/v1/knowledge-bases/",
    headers={"x-api-key": "YOUR_API_KEY"},
    json=data
)
result = response.json()
print(f"Knowledge base created: {result['knowledge_base']['id']}")
print(f"Ingestion status: {result['knowledge_base']['status']}")
```
</CodeGroup>

<Note>
For Milvus engine, ingestion starts automatically in the background. Use the check status endpoint to monitor progress.
</Note>

---

## Get Knowledge Base Details

<ParamField query="GET" path="/api/v1/knowledge-bases/{id}/">
  Retrieve detailed information about a specific knowledge base
</ParamField>

### Path Parameters

<ParamField path="id" type="string" required>
  The knowledge base ID
</ParamField>

### Response

```json
{
  "id": "kb_123",
  "name": "Product Knowledge Base",
  "description": "Product documentation and guides",
  "processing_engine": "milvus",
  "status": "completed",
  "progress": 100,
  "collection_count": 2,
  "total_datasources": 150,
  "collections": [
    {
      "id": "coll_123",
      "name": "Product Manuals",
      "description": "All product manuals and guides",
      "status": "completed",
      "progress": 100,
      "data_source_count": 10,
      "total_size": 20971520,
      "datasources": [...],
      "created_by": "user_123",
      "created_by_name": "John Doe",
      "company": "company_456",
      "company_name": "Acme Corp",
      "created_at": "2024-01-15T10:00:00Z",
      "updated_at": "2024-01-15T10:00:00Z"
    }
  ],
  "ingested_datasources": [...],
  "failed_datasources": [],
  "success_rate": 100,
  "chunking_strategy": {},
  "llm_config": {},
  "embedding_config": {
    "provider": "mistral",
    "model": "mistral-embed"
  },
  "processing_metadata": {},
  "created_by_name": "John Doe",
  "company_name": "Acme Corp",
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-15T10:35:00Z"
}
```

---

## Update Knowledge Base

<ParamField query="PUT/PATCH" path="/api/v1/knowledge-bases/{id}/">
  Update knowledge base details
</ParamField>

### Path Parameters

<ParamField path="id" type="string" required>
  The knowledge base ID
</ParamField>

### Request Body

```json
{
  "name": "Updated Knowledge Base Name",
  "description": "Updated description"
}
```

### Response

Returns the updated knowledge base object.

<Warning>
Changing processing engine or collections may require re-ingestion.
</Warning>

### Example

<CodeGroup>
```bash cURL
curl -X PATCH https://api-be.atthene.com/api/v1/knowledge-bases/kb_123/ \
  -H "x-api-key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "description": "Updated description"
  }'
```

```python Python
import requests

data = {
    "description": "Updated description"
}

response = requests.patch(
    "https://api-be.atthene.com/api/v1/knowledge-bases/kb_123/",
    headers={"x-api-key": "YOUR_API_KEY"},
    json=data
)
```
</CodeGroup>

---

## Delete Knowledge Base

<ParamField query="DELETE" path="/api/v1/knowledge-bases/{id}/">
  Delete a knowledge base and its associated data
</ParamField>

### Path Parameters

<ParamField path="id" type="string" required>
  The knowledge base ID
</ParamField>

### Response

Returns `204 No Content` on success.

### Example

<CodeGroup>
```bash cURL
curl -X DELETE https://api-be.atthene.com/api/v1/knowledge-bases/kb_123/ \
  -H "x-api-key: YOUR_API_KEY"
```

```python Python
import requests

response = requests.delete(
    "https://api-be.atthene.com/api/v1/knowledge-bases/kb_123/",
    headers={"x-api-key": "YOUR_API_KEY"}
)
```
</CodeGroup>

<Warning>
Deleting a knowledge base removes all ingested data and vector embeddings. This action cannot be undone.
</Warning>

---

## Check Ingestion Status

<ParamField query="GET" path="/api/v1/knowledge-bases/{id}/check_status/">
  Check the ingestion status of a knowledge base
</ParamField>

### Path Parameters

<ParamField path="id" type="string" required>
  The knowledge base ID
</ParamField>

### Response

```json
{
  "success": true,
  "message": "Status checked for knowledge base 'Product Knowledge Base'",
  "knowledge_base": {
    "id": "kb_123",
    "name": "Product Knowledge Base",
    "description": "Product documentation and guides",
    "processing_engine": "milvus",
    "status": "running",
    "progress": 50,
    "collections": [...],
    "collection_count": 2,
    "total_datasources": 150,
    "ingested_datasources": [...],
    "failed_datasources": [...],
    "success_rate": 98.67,
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:40:00Z"
  },
  "status_updated": true
}
```

### Example

<CodeGroup>
```bash cURL
curl -X GET https://api-be.atthene.com/api/v1/knowledge-bases/kb_123/check_status/ \
  -H "x-api-key: YOUR_API_KEY"
```

```python Python
import requests
import time

# Poll ingestion status
kb_id = "kb_123"
while True:
    response = requests.get(
        f"https://api-be.atthene.com/api/v1/knowledge-bases/{kb_id}/check_status/",
        headers={"x-api-key": "YOUR_API_KEY"}
    )
    status = response.json()
    
    kb_data = status['knowledge_base']
    print(f"Progress: {kb_data['progress']}%")
    print(f"Success rate: {kb_data['success_rate']}%")
    print(f"Total datasources: {kb_data['total_datasources']}")
    
    if kb_data['status'] == 'completed':
        print("Ingestion complete!")
        break
    elif kb_data['status'] == 'failed':
        print("Ingestion failed!")
        break
    
    time.sleep(5)  # Check every 5 seconds
```
</CodeGroup>

---

## Get Available Collections

<ParamField query="GET" path="/api/v1/knowledge-bases/available_collections/">
  Get collections available for the current user
</ParamField>

### Response

```json
{
  "success": true,
  "collections": [
    {
      "id": "coll_123",
      "name": "Product Manuals",
      "description": "Product documentation",
      "created_at": "2024-01-15T10:00:00Z",
      "datasource_count": 10
    },
    {
      "id": "coll_456",
      "name": "Support FAQs",
      "description": "FAQ documents",
      "created_at": "2024-01-14T09:00:00Z",
      "datasource_count": 5
    }
  ],
  "count": 2
}
```

### Example

<CodeGroup>
```bash cURL
curl -X GET https://api-be.atthene.com/api/v1/knowledge-bases/available_collections/ \
  -H "x-api-key: YOUR_API_KEY"
```

```python Python
import requests

response = requests.get(
    "https://api-be.atthene.com/api/v1/knowledge-bases/available_collections/",
    headers={"x-api-key": "YOUR_API_KEY"}
)
result = response.json()
print(f"Available collections: {result['count']}")
```
</CodeGroup>

---

## Knowledge Base Status

<ResponseField name="status" type="string">
  Current knowledge base status:
  
  - `pending` - Knowledge base is being created
  - `running` - Ingestion is in progress
  - `completed` - Knowledge base is ready for use
  - `failed` - Ingestion failed
</ResponseField>

---

## Processing Engines

<ResponseField name="processing_engine" type="string">
  The vector database/processing engine:
  
  - `milvus` - Milvus vector database with dense vector semantic search
  - `cognee` - Cognee AI knowledge base (coming soon)
</ResponseField>

---

## Complete Workflow Example

<CodeGroup>
```python Python
import requests
import time

BASE_URL = "https://api-be.atthene.com/api/v1"
headers = {"x-api-key": "YOUR_API_KEY"}

# 1. Upload files
print("Uploading files...")
file1 = open('doc1.pdf', 'rb')
file2 = open('doc2.pdf', 'rb')

response1 = requests.post(f"{BASE_URL}/files/", headers=headers, files={'file': file1})
response2 = requests.post(f"{BASE_URL}/files/", headers=headers, files={'file': file2})

file1_id = response1.json()['file']['id']
file2_id = response2.json()['file']['id']

# 2. Create collection
print("Creating collection...")
collection_data = {
    "name": "Support Docs",
    "description": "Support documentation collection"
}
coll_response = requests.post(f"{BASE_URL}/collections/", headers=headers, json=collection_data)
collection_id = coll_response.json()['collection']['id']

# Add files to collection
for file_id in [file1_id, file2_id]:
    requests.post(
        f"{BASE_URL}/collections/{collection_id}/add_data_source/",
        headers=headers,
        json={"data_source_id": file_id}
    )

# 3. Create knowledge base
print("Creating knowledge base...")
kb_data = {
    "name": "Support KB",
    "processing_engine": "milvus",
    "collections": [collection_id]
}
kb_response = requests.post(f"{BASE_URL}/knowledge-bases/", headers=headers, json=kb_data)
kb_id = kb_response.json()['knowledge_base']['id']
print(f"Knowledge base created: {kb_id}")

# 4. Monitor ingestion
print("Monitoring ingestion...")
while True:
    status_response = requests.get(
        f"{BASE_URL}/knowledge-bases/{kb_id}/check_status/",
        headers=headers
    )
    status = status_response.json()
    
    kb_data = status['knowledge_base']
    print(f"Progress: {kb_data['progress']}%")
    print(f"Success rate: {kb_data['success_rate']}%")
    
    if kb_data['status'] == 'completed':
        print("✓ Knowledge base ready!")
        break
    elif kb_data['status'] == 'failed':
        print("✗ Ingestion failed")
        break
    
    time.sleep(5)

# 5. Use in agent configuration
print("\nKnowledge base can now be used in agent configs:")
print(f"""
knowledge_bases:
  - name: "support_kb"
    knowledge_base_type: "milvus"
    knowledge_base_id: "{kb_id}"
    retrieval_config:
      top_k: 10
      metric_type: "COSINE"
""")
```
</CodeGroup>

---

## Error Responses

<AccordionGroup>
  <Accordion title="400 Bad Request">
    Invalid configuration or duplicate name
    
    ```json
    {
      "error": {
        "type": "validation_error",
        "message": "Knowledge base with this name already exists",
        "details": {...}
      }
    }
    ```
  </Accordion>
  
  <Accordion title="404 Not Found">
    Knowledge base not found
    
    ```json
    {
      "error": {
        "type": "not_found",
        "message": "Knowledge base not found"
      }
    }
    ```
  </Accordion>
  
  <Accordion title="500 Internal Server Error">
    Ingestion or processing error
    
    ```json
    {
      "error": {
        "type": "ingestion_error",
        "message": "Failed to process documents",
        "details": {
          "failed_documents": 5,
          "error_messages": [...]
        }
      }
    }
    ```
  </Accordion>
</AccordionGroup>
